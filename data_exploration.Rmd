---
title: "Geocoding BOPP Use Survey Responses"
author: "Maddie Berger"
date: "9/21/2020"
output: html_document
---

# Overview

This script is the first attempt at Geocoding survey output from Maptionnaire, since it no longer exports shapefiles. The objective is to eventually build a streamlined processes for cleaning and processing this kind of output data into a layer (read: feature class) that can be published on SeaSketch. 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(sf)
library(janitor)
library(here)
library(rgeos)
library(mapview)
```

# Respondents

This is the first tab in the output, meaning it contains data for the first page of the survey. It includes any identifying information of the respondent (name, etc) and which answers they chose for the radio button "Which sector are you in" question.

*Notes on radio button output:* 
Not sure why the initial column "what parish do you live in?" has three output columns
- After a column indicating if they answered the question, there is a column for each possible response. Right now, they are all FALSE which is somewhat perplexing? 
- It looks like it records how many sectors they indicated, but only one of them is detailed. The join may be able to solve this


What we would want to get from this sheet is demographic data on how far the survey is reached, so need to clean it up so that we can create survey demographics: 

- Name
- Gender
- Some idea of sector number - if not possible, can use other sheets probably 

```{r}

respondents <- read_csv(here("_raw_data", "respondents.csv")) %>% 
  janitor::clean_names()

aya_ex <- respondents %>% 
  filter(what_is_your_name == "Aya")

#what columns do we actually need to get all the info we want? 

respondents_clean <- respondents[-c(12:21)]# get rid of the all the columns that all have the same thing in them? 
  
```

# Creating shapefiles

Look at once of the activity specific ones to get shapefiles. Aquaculture as an example. 
```{r}

aquaculture_areas <- read_csv(here("_raw_data", "aquaculture_area.csv")) %>% 
  clean_names()

aquaculture_shp <- aquaculture_areas %>%
  filter(!is.na(wkt)) %>% #filter out na or st_as_sf will not run
  st_as_sf(wkt = "wkt", crs = 4326) #wgs84
  
mapview(aquaculture_shp)
```

Find the relative weights for value based on respondent id

```{r}

aquaculture_total <- aquaculture_shp %>% 
  group_by(respondent_id) %>% 
  mutate(
    values = as.numeric(please_indicate_the_relative_value_of_this_area_to_you)
  ) %>% 
  summarize(
    total_pts = sum(values)
  )



```

